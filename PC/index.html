<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>PC部クイズ！</title>
<style>
body {
  font-family: sans-serif;
  background-color: #222;
  color: white;
  margin: 0;
  overflow: hidden;
  text-align: center;
  transition: background-color 0.3s;
}
#container { padding-top: 50px; position: relative; z-index: 2;}
#container p { font-size: 2.5em; margin-bottom: 30px; }
#status {
  position: absolute;
  top: 10px;
  right: 20px;
  font-size: 1.5em;
  z-index: 2;
}
#endRoll {
  position: absolute;
  bottom: -100%;
  width: 100%;
  text-align: center;
  font-size: 2em;
  color: white;
  display: none;
}
#endRoll p { margin: 20px 0; line-height: 2em; }
canvas {
  position: absolute;
  top: 0;
  left: 0;
  z-index: 1;
}
/* 解答UI */
ul {
  list-style-type: none;
  padding: 15px;
  margin: 10px auto;
  display: flex;
  justify-content: center;
  background: #333;
  border-radius: 25px;
}
ul li { margin: 0 15px; }
ul li button {
  padding: 25px 50px;
  font-size: 2em;
  border-radius: 25px;
  border: none;
  background-color: #555;
  color: white;
  cursor: pointer;
  transition: background-color 0.3s;
}
ul li button:hover { background-color: #777; }
/* スタートボタン */
#startBtn {
  padding: 50px 100px;
  font-size: 3em;
  border-radius: 40px;
  border: none;
  background-color: #555;
  color: white;
  cursor: pointer;
  transition: background-color 0.3s;
}
#startBtn:hover { background-color: #777; }
</style>
</head>
<body>
<canvas id="fireworks"></canvas>
<div id="container">
  <h1>PC部クイズ！</h1>
  <button id="startBtn">スタート</button>
</div>
<div id="status"></div>

<div id="endRoll">
  <p>PC部 第2期 卒業！</p><br><br><br>
  <p>～みんなからのメッセージ～</p>
  <p>部長:横田 侑利<br>短い間だったけど、本当にありがとう！この部活をよろしく！</p>
  <p>副部長:武井 煌龍<br>今までありがとう！引退まで部活を楽しんでください！</p>
  <p>書記1:安地 湊祐<br>今までありがと～またいつか集まろうな</p>
  <p>書記2:清水 悠樹<br>思いつきません！</p>
  <p>部員:保田 陽斗<br><img src="Hphoto.jpeg" alt="THXs" class="roll-img"></p>
  <p>部員:関口 颯仁<br>PC部 最っっっっっっっっっっ高！</p><br>
  <p>～みんなから～<br>Thank you for the best club activities!</p><br>
  <p>～Dev～<br>Scriptor:関口 颯仁　Suggester:横田 侑利</p><br>
  <p>～Special Thanks～<br>顧問:佐藤 竜也先生　2年:原 宏彰</p>
  <p>2年:寄本 侑希　2年:鈴木 湊</p>
  <p>1年:岡藤 友璃　1年:佐藤 結優渚</p>
  <p>1年:江森 新　1年:中山 篤</p>
  <p>1年:田中 陽　1年:ファム キリン</p><br>
  <p>～Credit～<br>Text editor:VS Code　AI:GitHub</p>
  <p>Link to:github.com　Engine:Chrome & Edge</p>
  <p>Music:僕らまた by SG　Image:ONE PIECE by 尾田 栄一郎</p><br>
  <p><img src="名言.jpg" alt="koha" class="roll-img"></p>
  <p><img src="HaraD.jpg" alt="hara3" class="roll-img"></p>
  <p><video src="PigK.mp4" class="roll-video" autoplay></video></p>
  <p><video src="Ube.mp4" class="roll-video" autoplay></video></p>
  <p><img src="集合写真.jpg" alt="pccc" class="roll-img"></p><br>
  <p>～Thank you for everything～</p>
</div>

<audio id="endMusic" src="僕らまた.mp3" loop></audio>

<script>
const canvas = document.getElementById('fireworks');
const ctx = canvas.getContext('2d');
canvas.width = window.innerWidth;
canvas.height = window.innerHeight;

let particles = [];

// 花火放射型
function createFirework() {
  for(let j=0;j<3;j++){ // 同時3発
    const x = Math.random()*canvas.width;
    const y = Math.random()*canvas.height/2;
    for(let i=0;i<250;i++){
      const angle = Math.random()*Math.PI*2;
      const speed = Math.random()*15+5;
      particles.push({
        x:x, y:y,
        vx: Math.cos(angle)*speed,
        vy: Math.sin(angle)*speed,
        alpha:1,
        color:`hsl(${Math.random()*360},100%,50%)`,
        size:Math.random()*15+5,
        prevX:x, prevY:y
      });
    }
  }
}

function drawFireworks(){
  ctx.clearRect(0,0,canvas.width,canvas.height);
  for(let i=particles.length-1;i>=0;i--){
    let p = particles[i];
    ctx.strokeStyle = p.color;
    ctx.lineWidth = 2;
    ctx.beginPath();
    ctx.moveTo(p.prevX, p.prevY);
    ctx.lineTo(p.x, p.y);
    ctx.stroke();
    p.prevX = p.x;
    p.prevY = p.y;
    p.x += p.vx;
    p.y += p.vy;
    p.vy += 0.05; // 重力
    p.alpha -= 0.015;
    if(p.alpha<=0) particles.splice(i,1);
  }
  requestAnimationFrame(drawFireworks);
}
drawFireworks();

// クイズデータ
const quiz=[
  {q:"PC部の設立年は？",a:["2021","2022","2023"],correct:1},
  {q:"PC部で一番人気の活動は？",a:["ゲーム","プログラミング","昼寝"],correct:0},
  {q:"卒業生の人数は？",a:["9人","8人","7人"],correct:2},
  {q:"部室はどこ？",a:["PC室","金工室","木工室"],correct:2},
  {q:"活動日は？",a:["自由参加","毎週水曜","毎日"],correct:1},
  {q:"部員の必須アイテムは？",a:["ノートPC","ペン","定規"],correct:0},
  {q:"PC部の顧問は？",a:["消しカス","たつや","こはく"],correct:1},
  {q:"PC部の部長は？",a:["原さん","たかし","ゆうり"],correct:2},
  {q:"原さんは？",a:["神！","紙！","上！"],correct:0},
  {q:"最後に感謝を伝える言葉は？",a:["ありがとうPC部！","またね！","頑張れ！"],correct:0}
];

let current=0, score=0;
const container=document.getElementById("container");
const status=document.getElementById("status");
const startBtn=document.getElementById("startBtn");
const endRoll=document.getElementById("endRoll");
const music = document.getElementById("endMusic");

function showQuestion(){
  const q=quiz[current];
  container.innerHTML=`<p>${q.q}</p><ul></ul>`;
  const ul=container.querySelector("ul");
  status.textContent=`${current+1}/${quiz.length}`;
  q.a.forEach((choice,i)=>{
    const li=document.createElement("li");
    const btn=document.createElement("button");
    btn.textContent=choice;
    btn.onclick=()=>checkAnswer(i);
    li.appendChild(btn);
    ul.appendChild(li);
  });
}

function flashRed(){
  document.body.style.backgroundColor="red";
  setTimeout(()=>{document.body.style.backgroundColor="#222";},300);
}

function checkAnswer(i){
  if(i===quiz[current].correct){
    score++;
    createFirework();
  }else{
    flashRed();
  }
  current++;
  if(current<quiz.length){
    setTimeout(showQuestion,500);
  }else{
    setTimeout(showResult,1000);
  }
}

function showResult(){
  container.innerHTML = `
    <p id="resultText" style="opacity:1; transition: opacity 1s;">クイズ終了！<br>10問中${score}問正解！</p>
  `;
  status.textContent = "";

  // 3秒後に結果をフェードアウト
  setTimeout(() => {
    const resultText = document.getElementById("resultText");
    if (resultText) {
      resultText.style.opacity = 0; // フェードアウト
      // 1秒後に削除
      setTimeout(() => {
        resultText.remove();
      }, 1000);
    }
  }, 3000);

  // 4秒後にエンドロール開始
  setTimeout(startEndRoll, 4000);
}

function startEndRoll(){
  endRoll.style.display="block";
  music.currentTime=0;
  music.play();
  let pos=-endRoll.offsetHeight;
  function scroll(){
    pos+=0.5; // スクロール速度
    endRoll.style.bottom=pos+"px";
    if(pos<window.innerHeight) requestAnimationFrame(scroll);
  }
  scroll();
}

startBtn.onclick=()=>{
  music.play(); music.pause(); // 自動再生対策
  startBtn.style.display="none";
  current=0; score=0;
  showQuestion();
};
</script>
</body>
</html>
